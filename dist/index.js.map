{"version":3,"file":"index.js","sources":["../src/card.js","../src/index.js"],"sourcesContent":["import * as yaml from \"https://unpkg.com/js-yaml?module\"\r\nimport css from \"./card.css\";\r\n\r\nexport class RecipeCard extends HTMLElement {\r\n\r\n    // private properties\r\n    _config;\r\n    _hass;\r\n    _elements = {};\r\n    _parsedRecipes;\r\n    _recipeIndex;\r\n\r\n    // lifecycle\r\n    constructor() {\r\n        super();\r\n        this.yamlEntryToLi = this.yamlEntryToLi.bind(this);\r\n    }\r\n\r\n    setConfig(config) {\r\n        this._config = config;\r\n        this.doCard();\r\n        this.doStyle();\r\n        this.doAttach();\r\n        this.doQueryElements();\r\n        this.doCheckConfig();\r\n        this.doFetchRecipes();\r\n    }\r\n\r\n    set hass(hass) {\r\n        this._hass = hass;\r\n    }\r\n\r\n    // jobs\r\n    doCheckConfig() {\r\n        if (!this._config.url) {\r\n            throw new Error(\"Please define a url in config!\");\r\n        }\r\n    }\r\n\r\n    async doFetchRecipes() {\r\n        try {\r\n            const response = await fetch(this._config.url);\r\n            const yamlText = await response.text();\r\n\r\n            this._parsedRecipes = yaml.load(yamlText);\r\n            // this._recipeIndex = Math.floor(Math.random() * this._parsedRecipes.length);\r\n            this._recipeIndex = 121;\r\n            this.doFillCard();\r\n        } catch (error) {\r\n            throw new Error(`Error fetching or parsing the recipe file: ${error}`);\r\n        }\r\n    }\r\n\r\n    doCard() {\r\n        this._elements.card = document.createElement(\"ha-card\");\r\n        this._elements.card.innerHTML = `\r\n            <div class=\"selectdiv\"></div>\r\n            <div class=\"content\"></div>\r\n        `;\r\n    }\r\n\r\n    doStyle() {\r\n        this._elements.style = document.createElement(\"style\");\r\n        this._elements.style.textContent = css;\r\n    }\r\n\r\n    doAttach() {\r\n        this.attachShadow({mode: \"open\"});\r\n        this.shadowRoot.append(this._elements.style, this._elements.card);\r\n    }\r\n\r\n    doQueryElements() {\r\n        const card = this._elements.card;\r\n        this._elements.selectdiv = card.querySelector(\".selectdiv\");\r\n        this._elements.content = card.querySelector(\".content\");\r\n    }\r\n\r\n\r\n    doFillSelect() {\r\n        let groupedRecipes = this._parsedRecipes.reduce((grouped, recipe, index) => {\r\n            const category = recipe.category || \"Onbekend\";\r\n            if (!grouped[category]) {\r\n                grouped[category] = [];\r\n            }\r\n            grouped[category].push({...recipe, index});\r\n            return grouped;\r\n        }, {});\r\n\r\n        const categoryOptions = Object.keys(groupedRecipes).map(category => {\r\n            // TODO let value be the index (key) in this._parsedRecipes instead of name\r\n            const options = groupedRecipes[category].map(recipe => {\r\n                return `<option value=\"${recipe.index}\">${recipe.name}</option>`;\r\n            }).join(\"\");\r\n            return `<optgroup label=\"${category}\">${options}</optgroup>`;\r\n        }).join(\"\");\r\n\r\n        this._elements.selectdiv.innerHTML = `\r\n            <select id=\"recipe-selector\">\r\n                <option value=\"\">Select a recipe...</option>\r\n                ${categoryOptions}\r\n            </select>\r\n        `;\r\n\r\n        this._elements.selectdiv.querySelector(\"#recipe-selector\").addEventListener(\"change\", (event) => {\r\n            this._recipeIndex = event.target.value\r\n            if (this._recipeIndex !== -1) {\r\n                this.doFillContent();\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n    doFillContent() {\r\n        this.recipe = this._parsedRecipes[this._recipeIndex];\r\n        if (!this.recipe) {\r\n            this._elements.content.innerHTML = \"Loading recipe...\";\r\n            return;\r\n        }\r\n\r\n        this._elements.content.innerHTML = `\r\n            <div class=\"recipe-title\">${this.recipe.name}</div>\r\n            <div class=\"recipe-content\">\r\n                <i>IngrediÃ«nten${this.recipe?.persons ? ` (${this.recipe.persons} personen)` : \"\"}:</i>\r\n                <ul class=\"ingredient-list\">\r\n                    ${this.recipe.ingredients.map(this.yamlEntryToLi).join(\"\")}\r\n                </ul>\r\n                <br/> \r\n                <i>Bereiding:</i>\r\n                <ol class=\"instruction-list\">\r\n                    ${this.recipe.instructions.map(this.yamlEntryToLi).join(\"\")}\r\n                </ol>\r\n            </div>\r\n        `;\r\n    }\r\n\r\n    doFillCard() {\r\n        this.doFillSelect();\r\n        this.doFillContent();\r\n    }\r\n\r\n    // helpers\r\n    yamlEntryToLi(yamlEntry) {\r\n        if (Array.isArray(yamlEntry)) {\r\n            return \"<ul>\" + yamlEntry.map(val => this.yamlEntryToLi(val)).join(\"\") + \"</ul>\";\r\n        } else if (typeof yamlEntry === \"object\") {\r\n            let [key, value] = Object.entries(yamlEntry)[0];\r\n            key = key.charAt(0).toUpperCase() + key.slice(1);\r\n            if (value) {\r\n                if (Array.isArray(value)) {\r\n                    value = \"<ul>\" + value.map(val => this.yamlEntryToLi(val)).join(\"\") + \"</ul>\";\r\n                }\r\n                value = \": \" + value;\r\n            } else {\r\n                value = \"\";\r\n            }\r\n            return `<li><span class=\"ingredient\">${key}</span><span class=\"amount\">${value}</span></li>`;\r\n        } else {\r\n            yamlEntry = yamlEntry.charAt(0).toUpperCase() + yamlEntry.slice(1);\r\n            return `<li>${yamlEntry}</li>`;\r\n        }\r\n    }\r\n}","import {RecipeCard} from \"./card\";\r\n\r\ncustomElements.define(\"recipe-card\", RecipeCard);"],"names":[],"mappings":"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"}